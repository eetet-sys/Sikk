<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì‹ê²°(é£Ÿçµ) - ë§ˆìŠ¤í„° ì²˜ë°© ì‹œìŠ¤í…œ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&family=Song+Myung&display=swap');
        :root { --paper: #fdfcf8; --ink: #1a1a1a; --wood: #4A6741; --fire: #A24841; --earth: #C29A5B; --metal: #7D7D7D; --water: #3E5266; }
        body { font-family: 'Noto Serif KR', serif; background-color: #dcd9d0; margin: 0; padding: 15px; color: var(--ink); line-height: 1.6; }
        .app-container { max-width: 420px; margin: auto; background: var(--paper); border: 1px solid #c9c4b9; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
        .header { padding: 45px 20px; text-align: center; border-bottom: 1px double #d1cdbf; background: #f9f7f0; }
        .header h1 { font-family: 'Song Myung', serif; font-size: 2.8rem; margin: 0; letter-spacing: 15px; text-indent: 15px; }
        .content { padding: 30px 25px; }
        .section-title { font-size: 0.85rem; font-weight: 700; margin: 25px 0 12px; border-left: 3px solid var(--ink); padding-left: 10px; }
        input, select, button { width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #d1cdbf; font-family: inherit; box-sizing: border-box; }
        button { background: var(--ink); color: #fff; font-weight: 700; cursor: pointer; border: none; }
        
        /* ëª¨ë‹¬ ë° ì„¤ë¬¸ */
        #diagModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:1000; justify-content:center; align-items:center; padding:20px; }
        .survey-card { background:#fff; padding:30px; border-radius:15px; width:100%; max-width:360px; }
        .survey-item { display: none; }
        .survey-item.active { display: block; }
        .opt-btn { background:#fff; color:var(--ink); text-align:left; font-weight:normal; margin-bottom:10px; border:1px solid #eee; }
        .opt-btn:active { background:#f9f7f0; }

        /* ì²˜ë°©ì „ */
        #prescriptionCard { display: none; padding: 30px 20px; text-align: center; border: 10px double #d1cdbf; margin: 10px; background: var(--paper); }
        .badge { display: inline-block; padding: 3px 10px; background: #eee; border-radius: 15px; font-size: 0.7rem; margin-bottom: 10px; }
        .advice-box { background: #f9f7f0; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: left; font-size: 0.85rem; }
        .tag-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; margin: 10px 0; }
        .tag { padding: 4px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.75rem; background:#fff; }
    </style>
</head>
<body>

<div class="app-container">
    <div id="inputForm">
        <div class="header"><h1>é£Ÿ çµ</h1><p>2026 ì •ë°€ ìš´ëª… ì²˜ë°©</p></div>
        <div class="content">
            <input type="text" id="userName" placeholder="ì´ë¦„ ì…ë ¥">
            <input type="date" id="birthDate" value="1995-01-01">
            <select id="birthTime"><option value="12">åˆì‹œ (11:30~13:29)</option></select>
            <button onclick="openSurvey()">ë¶„ì„ ì‹œì‘</button>
        </div>
    </div>

    <div id="prescriptionCard">
        <div id="resWeather" class="badge"></div>
        <div id="resDate" style="font-size: 0.7rem; color:#999;"></div>
        <h2 id="resBodyType" style="margin:10px 0; font-family:'Song Myung';"></h2>
        <div style="height:150px;"><canvas id="myChart"></canvas></div>
        <div id="resLack" style="font-weight:bold; font-size:1.2rem; margin-top:10px;"></div>
        
        <div class="advice-box" id="resAdvice"></div>
        <div class="section-title">ì¶”ì²œ ì‹ì¬ë£Œ</div>
        <div class="tag-box" id="goodFoods"></div>
        <div class="section-title">ì£¼ì˜í•  ì‹í’ˆ</div>
        <div class="tag-box" id="badFoods" style="color:#a24841;"></div>
        
        <div class="advice-box" id="resLife" style="border-left:4px solid var(--wood);"></div>
        <div id="resAmulet" style="margin-top:20px; border:1px solid #A24841; padding:10px; font-family:'Song Myung'; color:#A24841;">
            [ ì˜¤ëŠ˜ì˜ ìˆ˜í˜¸ ë¶€ì  ]<br><span style="font-size:2rem;">ç¦</span>
        </div>
    </div>
</div>

<div id="diagModal">
    <div class="survey-card">
        <h3 id="surveyTitle">ì§„ë‹¨ (1/4)</h3>
        <div id="surveyItems">
            <div class="survey-item active" id="s1">
                <p>1. ì²´ê²©ê³¼ ê³¨ê²©ì´ ì–´ë– ì‹ ê°€ìš”?</p>
                <button class="opt-btn" onclick="save(1, 'íƒœìŒì¸')">ê³¨ê²©ì´ í¬ê³  ì²´êµ¬ê°€ ë‹¹ë‹¹í•¨</button>
                <button class="opt-btn" onclick="save(1, 'ì†ŒìŒì¸')">í•˜ì²´ê°€ ë°œë‹¬í•˜ê³  ê· í˜•ì¡íŒ ê°€ëƒ˜í”ˆ ì²´í˜•</button>
                <button class="opt-btn" onclick="save(1, 'ì†Œì–‘ì¸')">ìƒì²´ê°€ ë°œë‹¬í•˜ê³  ê±¸ìŒê±¸ì´ê°€ ë¹ ë¦„</button>
            </div>
            <div class="survey-item" id="s2">
                <p>2. ì†Œí™” ìƒíƒœì™€ ì‹ì„±ì€ ì–´ë– ì‹ ê°€ìš”?</p>
                <button class="opt-btn" onclick="save(2, 'íƒœìŒì¸')">ë¬´ì—‡ì´ë“  ì˜ ë¨¹ê³  ëŒ€ì‹ê°€ê°€ ë§ìŒ</button>
                <button class="opt-btn" onclick="save(2, 'ì†ŒìŒì¸')">ì†Œí™”ê¸°ê°€ ì•½í•´ ì¡°ê¸ˆì”© ìì£¼ ë¨¹ìŒ</button>
                <button class="opt-btn" onclick="save(2, 'ì†Œì–‘ì¸')">ì‹œì›í•œ ìŒì‹ì„ ì¢‹ì•„í•˜ê³  ì†Œí™”ê°€ ë¹ ë¦„</button>
            </div>
            </div>
    </div>
</div>

<script>
    let answers = {};
    const foodData = {
        'íƒœìŒì¸': { good: ['ì†Œê³ ê¸°','ë¬´','ì—°ê·¼','ë°°','ì½©','ìœ¨ë¬´','ë“¤ê¹¨'], bad: ['ë‹­ê³ ê¸°','ì¡°ê°œ','ë©”ë°€','ìˆ '] },
        'ì†ŒìŒì¸': { good: ['ë‹­ê³ ê¸°','ì¸ì‚¼','ë¶€ì¶”','ìƒê°•','ì‚¬ê³¼','ì°¹ìŒ€'], bad: ['ë¼ì§€ê³ ê¸°','ìˆ˜ë°•','ëƒ‰ë©´','ë¹™ê³¼ë¥˜'] },
        'ì†Œì–‘ì¸': { good: ['ë¼ì§€ê³ ê¸°','ì˜¤ì´','ìˆ˜ë°•','ì „ë³µ','ë³´ë¦¬','ë©”ë°€'], bad: ['ë‹­ê³ ê¸°','ì¸ì‚¼','ê¿€','ë§¤ìš´ê³ ì¶”'] }
    };
    const lifeData = {
        'íƒœìŒì¸': "ë•€ì´ ë‚  ì •ë„ì˜ ê³ ê°•ë„ ìš´ë™ì´ ì¢‹ìŠµë‹ˆë‹¤. ì •ì²´ë˜ê¸° ì‰¬ìš°ë‹ˆ ì‹í›„ ì‚°ì±…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.",
        'ì†ŒìŒì¸': "ì²´ë ¥ ì†Œëª¨ê°€ ì ì€ ìš”ê°€ë‚˜ ìŠ¤íŠ¸ë ˆì¹­ì´ ì í•©í•©ë‹ˆë‹¤. í•­ìƒ ë°œì„ ë”°ëœ»í•˜ê²Œ ìœ ì§€í•˜ì„¸ìš”.",
        'ì†Œì–‘ì¸': "í•˜ì²´ ê°•í™” ìš´ë™(ìŠ¤ì¿¼íŠ¸)ì´ ë³´ì•½ì…ë‹ˆë‹¤. ëª…ìƒì„ í†µí•´ ë§ˆìŒì˜ ì—´ì„ ì‹íˆì„¸ìš”."
    };

    function openSurvey() { document.getElementById('diagModal').style.display='flex'; }
    
    function save(step, type) {
        answers[step] = type;
        if(step < 2) { // ì§ˆë¬¸ ìˆ˜ì— ë”°ë¼ ì¡°ì •
            document.getElementById('s1').classList.remove('active');
            document.getElementById('s2').classList.add('active');
            document.getElementById('surveyTitle').innerText = "ì§„ë‹¨ (2/4)";
        } else {
            analyze();
        }
    }

    function analyze() {
        document.getElementById('diagModal').style.display='none';
        const type = answers[1]; // ë‹¨ìˆœí™”ëœ ë¡œì§
        const now = new Date();
        const solar = Solar.fromDate(now);
        const term = solar.getTerm(); // [ê²€ìƒ‰ ê¸°ëŠ¥] í˜„ì¬ ì ˆê¸° íŒŒì•…

        // UI ë°ì´í„° ë°”ì¸ë”©
        document.getElementById('resWeather').innerText = `ğŸŒ¡ï¸ 2026.02.04 ì„œìš¸: -2Â°C (í•œíŒŒ/ì…ì¶˜)`;
        document.getElementById('resDate').innerText = `${now.toLocaleDateString()} (ìŒë ¥ ${solar.getLunar().getMonth()}ì›”)`;
        document.getElementById('resBodyType').innerText = `[ ì •ë°€ ì²´ì§ˆ: ${type} ]`;
        document.getElementById('resAdvice').innerHTML = `<strong>âœ¨ ${term} ì ˆê¸° ì²˜ë°©:</strong> ì˜¤ëŠ˜ì€ ë´„ì´ ì‹œì‘ë˜ëŠ” ${term}ì…ë‹ˆë‹¤. ${type} ë‹˜ì€ ê²¨ìš¸ë‚´ ìŒ“ì¸ ë…ì†Œë¥¼ ë°°ì¶œí•˜ê¸° ìœ„í•´ ë”°ëœ»í•œ ì°¨ë¥¼ ë“œì„¸ìš”.`;
        
        // ìŒì‹ ì •ë³´ ë Œë”ë§
        document.getElementById('goodFoods').innerHTML = foodData[type].good.map(f => `<span class="tag">#${f}</span>`).join('');
        document.getElementById('badFoods').innerHTML = foodData[type].bad.map(f => `<span class="tag">#${f}</span>`).join('');
        document.getElementById('resLife').innerText = `ğŸƒ ë¼ì´í”„ìŠ¤íƒ€ì¼: ${lifeData[type]}`;

        document.getElementById('inputForm').style.display='none';
        document.getElementById('prescriptionCard').style.display='block';
        
        renderChart();
    }

    function renderChart() {
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
            type: 'radar',
            data: { labels: ['ëª©','í™”','í† ','ê¸ˆ','ìˆ˜'], datasets: [{ data: [3,4,2,5,3], borderColor: '#1a1a1a', backgroundColor: 'rgba(0,0,0,0.1)' }] },
            options: { scales: { r: { ticks: { display: false } } }, plugins: { legend: { display: false } } }
        });
    }
</script>
</body>
</html>
